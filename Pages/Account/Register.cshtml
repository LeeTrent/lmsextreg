@page
@model RegisterModel
@{
    ViewData["Title"] = "User Registration";
}

<h2>@ViewData["Title"]</h2>
<h4 style="margin-top:0">Create a new account</h4>
<div class="row">
    <div class="col-md-4">
        <form asp-route-returnUrl="@Model.ReturnUrl" method="post">
            <div asp-validation-summary="All" class="text-danger"></div>
             <div class="required-field-block">
                <input asp-for="Input.Email" class="form-control" style="margin-top:0" placeholder="Email address"/>
                <div class="required-icon"><div class="text">*</div></div>                
                <span asp-validation-for="Input.Email" class="text-danger"></span>
            </div>
            <div class="required-field-block">
                <input asp-for="Input.Password" class="form-control" placeholder="Password" />
                <div class="required-icon"><div class="text">*</div></div>   
                <span asp-validation-for="Input.Password" class="text-danger"></span>
            </div>
            <div class="required-field-block">
                <input asp-for="Input.ConfirmPassword" class="form-control" placeholder="Confirm password" />
                <span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
                <div class="required-icon"><div class="text">*</div></div>   
            </div>
             <div class="required-field-block">
                <input asp-for="Input.FirstName" class="form-control" placeholder="First Name"/>
                <div class="required-icon"><div class="text">*</div></div>                
                <span asp-validation-for="Input.FirstName" class="text-danger"></span>
            </div>
           <div class="form-group">
                <input asp-for="Input.MiddleName" class="form-control" placeholder="Middle Name" />
                <span asp-validation-for="Input.MiddleName" class="text-danger"></span>
            </div>  
             <div class="required-field-block">
                <input asp-for="Input.LastName" class="form-control" placeholder="Last Name" />
                <div class="required-icon"><div class="text">*</div></div> 
                <span asp-validation-for="Input.LastName" class="text-danger"></span>
            </div>    
           <div class="required-field-block">
                <input asp-for="Input.JobTitle" class="form-control" placeholder="Job Title" />
                <div class="required-icon"><div class="text">*</div></div> 
                <span asp-validation-for="Input.JobTitle" class="text-danger"></span>
            </div>       
            <div class="required-field-block" style="margin-top:10px;">
                <select id="AgencySelectObj" asp-for="Input.AgencyID" class="form-control"
                        asp-items="@Model.AgencySelectList">
                    <option value="">-- Select Agency --</option>
                </select>
                <div class="required-icon" style="margin-right:17px;"><div class="text">*</div></div> 
                <span asp-validation-for="Input.AgencyID" class="text-danger"></span>
            </div>     
            <div class="required-field-block" style="margin-top:10px;">
                <select id="SubAgencySelectObj" asp-for="Input.SubAgencyID" class="form-control"
                        asp-items="@Model.SubAgencySelectList">
                    <option value="">-- Select SubAgency --</option>
                </select>
                <div class="required-icon" style="margin-right:17.5px;"><div class="text">*</div></div> 
                <span asp-validation-for="Input.SubAgencyID" class="text-danger"></span>
            </div>  
            <div class="form-group">
                <div style="margin-top:10px;padding:10px;border: 1px dotted #000;">
                    <p style="text-align:center;font-weight:bold;">Rules of Behavior</p>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer placerat lectus nec tortor vehicula venenatis. Nulla venenatis pharetra auctor. Donec laoreet metus in odio viverra hendrerit. Suspendisse luctus mauris lorem, et imperdiet ante fermentum varius. Nunc eu consequat tellus. In nec tincidunt nulla, malesuada eleifend neque. Proin placerat velit et lacus porttitor, a semper risus aliquet. Suspendisse orci lorem, pretium quis luctus ut, finibus pulvinar lacus.</p>
                    <p>Fusce ac lorem at quam convallis malesuada. Quisque nec placerat ligula. Nunc interdum mauris ac tempus fermentum. Duis at auctor mi. Integer vitae enim enim. Vivamus quis felis laoreet arcu rhoncus blandit. Pellentesque et diam lobortis, laoreet justo non, ultrices nisl. Vestibulum vitae enim sollicitudin ligula luctus imperdiet.</p>               
                </div> 
            </div>
            <div class="required-field-block" style="margin-top:0;padding:10px;border: 1px dotted #000;"> 
                <input asp-for="Input.RulesOfBehaviorAgreedTo" />
                <label asp-for="Input.RulesOfBehaviorAgreedTo"></label>
                <div class="required-icon"><div class="text">*</div></div> 
                <br/>
                <span asp-validation-for="Input.RulesOfBehaviorAgreedTo" class="text-danger"></span>
            </div>    



             <!-- <div class="required-field-block" style="margin-top:10px;">
                <label>Rules of Behavior:</label>
                <div class="required-icon"><div class="text">*</div></div> 
                <div style="font-size:large;color:#1589FF;padding:10px;border: 1px solid #000;">
                    Rules of Behavior text goes here ...
                  
                    <div class="form-group"> 
                        <input asp-for="Input.RulesOfBehaviorAgreedTo" />
                        <label asp-for="Input.RulesOfBehaviorAgreedTo"></label>
                        <br/>
                        <span asp-validation-for="Input.RulesOfBehaviorAgreedTo" class="text-danger"></span>
                    </div>      
                 </div>               
            </div> -->
            <button type="submit" class="btn btn-primary">Register</button>
        </form>
    </div>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
    <!-- <script>
        $(document).ready(function() {
            $("#SubAgencySelectObj").prop("disabled", true);
        });    
    </script> -->
    <script>
        $(function() {
            $("#AgencySelectObj").change(function() {   
                var selectedAgencyVal = $("#AgencySelectObj").val();
                var subAgencySelectObj = $('#SubAgencySelectObj');
                subAgencySelectObj.empty();
                if (selectedAgencyVal != null && selectedAgencyVal != '') {
                     $.ajax({
                        type: 'GET',
                        url: '/Account/Register?handler=SubAgenciesInAgency',
                        contentType: "applications/json",
                        data: {
                            agyID: selectedAgencyVal
                        },
                        success: function(data) {
                            $("#SubAgencySelectObj").prop("disabled", false);
                            subAgencySelectObj.append('<option value="">' + '-- Select SubAgency --' + '</option>');
                            $.each(data, function(idx, subAgency) {
                                subAgencySelectObj.append('<option value="' + subAgency.value + '">' + subAgency.text + '</option>');
                            });
                        },
                        error: function(excErr) {
                            alert("error");
                            console.log("AJAX error retrieving sub-agencies: ");
                            console.log(excErr);
                            console.log("selectedAgencyVal: ")
                            console.log(selectedAgencyVal);
                        }
                    });
                }
            });
        });
    </script>
    <script>
        // extend range validator method to treat checkboxes differently
        var defaultRangeValidator = $.validator.methods.range;
        $.validator.methods.range = function(value, element, param) {
            if(element.type === 'checkbox') {
                // if it's a checkbox return true if it is checked
                return element.checked;
            } else {
                // otherwise run the default validation function
                return defaultRangeValidator.call(this, value, element, param);
            }
        }
    </script>
    <script>
        $(function() {
            $('.required-icon').tooltip({
                placement: 'left',
                title: 'Required field'
                });
        });
    </script>
}
